<?php
/**
 * PsStudentBmiTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PsStudentBmiTable extends Doctrine_Table {

	/**
	 * Returns an instance of this class.
	 *
	 * @return object PsStudentBmiTable
	 */
	public static function getInstance() {

		return Doctrine_Core::getTable ( 'PsStudentBmi' );
	}

	public function doSelectQuery(Doctrine_Query $query) {

		$alias = $query->getRootAlias ();

		$query->addSelect ( $alias . '.is_month AS is_month, ' . $alias . '.sex AS sex,' . $alias . '.min_height1 AS min_height1,' . $alias . '.min_height AS min_height,' . $alias . '.medium_height AS medium_height,' . $alias . '.max_height AS max_height,' . $alias . '.max_height1 AS max_height1,' . $alias . '.min_weight1 AS min_weight1,' . $alias . '.min_weight AS min_weight,' . $alias . '.medium_weight AS medium_weight,' . $alias . '.max_weight AS max_weight,' . $alias . '.max_weight1 AS max_weight1,' . $alias . '.updated_at,CONCAT(u.first_name," ",u.last_name) AS updated_by' )
			->leftJoin ( $alias . '.UserUpdated u' );

		return $query;
	}

	public function getStudentBmi($sex = null) {

		$q = $this->createQuery ('a')->select ( 'a.*' );
		
		if($sex != ''){
			$q->where('a.sex = ?', $sex);
		}
		
		$q->orderBy ( 'a.is_month DESC' );

		return $q->execute ();
	}
}