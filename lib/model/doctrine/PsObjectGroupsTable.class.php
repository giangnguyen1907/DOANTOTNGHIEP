<?php

/**
 * PsObjectGroupsTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PsObjectGroupsTable extends Doctrine_Table {

	/**
	 * Returns an instance of this class.
	 *
	 * @return object PsObjectGroupsTable
	 */
	public static function getInstance() {

		return Doctrine_Core::getTable ( 'PsObjectGroups' );
	}

	/**
	 * FUNCTION: doSelectQuery(Doctrine_Query $query)
	 *
	 * @param
	 *        	- Doctrine SQL
	 * @return - string SQL
	 */
	public function doSelectQuery(Doctrine_Query $query) {

		$alias = $query->getRootAlias ();
		$query->addSelect ( $alias . '.id,' . $alias . '.title,' . $alias . '.note,' . $alias . '.iorder, ' . $alias . '.is_activated, ' . $alias . '.updated_at,CONCAT(u.first_name," ",u.last_name) AS updated_by' )
			->leftJoin ( $alias . '.UserUpdated u', true )
			->addOrderBy ( $alias . '.iorder asc' );

		return $query;
	}

	/**
	 * FUNCTION: setSQL()
	 *
	 * @return - string SQL
	 */
	public function setSQL($is_activated = PreSchool::ACTIVE) {

		$q = $this->createQuery ( 'a' )
			->select ( 'a.id,a.title as name' );

		if ($is_activated != null && $is_activated >= 0)
			$q->where ( 'a.is_activated =?', $is_activated );

		$q->orderBy ( 'a.iorder' );

		return $q;
	}
	
	public function setSQLPsObjectGroups($getField = null, $object) {
		$q = $this->createQuery ('a')->select ( $getField != '' ? $getField : '*' );
		$q->where ( 'a.id =?', $object );
		$q->orderBy ( 'a.iorder' );
		return $q;
	}
	
}