<?php

/**
 * PsTypeSchoolTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PsTypeSchoolTable extends Doctrine_Table {

	/**
	 * Returns an instance of this class.
	 *
	 * @return object PsTypeSchoolTable
	 */
	public static function getInstance() {

		return Doctrine_Core::getTable ( 'PsTypeSchool' );
	}

	/**
	 * FUNCTION: doSelectQuery(Doctrine_Query $query)
	 *
	 * @param
	 *        	Doctrine SQL
	 * @return string SQL
	 */
	public function doSelectQuery(Doctrine_Query $query) {

		$alias = $query->getRootAlias ();
		$query->addSelect ( $alias . '.title,' . $alias . '.description,' . $alias . '.iorder, ' . $alias . '.updated_at,' . $alias . '.user_updated_id, CONCAT(u.first_name," ",u.last_name) AS updated_by' )
			->leftJoin ( $alias . '.UserUpdated u', true )
			->addOrderBy ( $alias . '.iorder asc' );
		return $query;
	}

	// Lay gia tri Max cua iorder, return: int - max order
	public function getMaxIorder() {

		return $this->createQuery ()
			->select ( 'MAX(iorder) AS max_order' )
			->fetchOne ()
			->getMaxOrder ();
	}
}